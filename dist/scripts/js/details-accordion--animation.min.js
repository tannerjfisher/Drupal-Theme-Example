"use strict";

/**
 * @file
 * Animates the details accordion.
 */
(function ($, Drupal) {
  Drupal.behaviors.details_animation = {
    attach: function attach(context) {
      $(context).find('.dialog-off-canvas-main-canvas details').once('details-animation').each(function () {
        function setDetailsHeight(selector) {
          var wrapper = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;

          var setHeight = function setHeight(detail) {
            var open = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
            detail.open = open;
            var rect = detail.getBoundingClientRect();
            detail.dataset.width = rect.width;
            detail.style.setProperty(open ? "--expanded" : "--collapsed", "".concat(rect.height, "px"));
          };

          var details = wrapper.querySelectorAll(selector);
          var RO = new ResizeObserver(function (entries) {
            return entries.forEach(function (entry) {
              var detail = entry.target;
              var width = parseInt(detail.dataset.width, 10);

              if (width !== parseInt(entry.borderBoxSize[0].inlineSize, 10)) {
                detail.removeAttribute('style');
                setHeight(detail);
                setHeight(detail, true);
                detail.open = false;
              }
            });
          });
          details.forEach(function (detail) {
            RO.observe(detail);
          });
        }
        /* Run it */


        setDetailsHeight('.dialog-off-canvas-main-canvas details');
      });
    }
  };
})(jQuery, Drupal);